<html>
<LINK REL=STYLESHEET type="text/css" HREF="synrc.css">
<title>Mandala</title><body style="padding: 0; margin: 20;">
<center><h1>SNMP Mandala</h1></center><br>
 <div align=center valign=top>
<canvas id="mandala" width="1000" height="600"></canvas>
</div>
<script>

     function drawSquare(x,y,item) {
              var startx = 4; var starty = 120;
              context.strokeRect(startx+x-1,starty+y-1,52,52);
              context.fillRect(startx+x,starty+y,50,50); }

     function drawSectionName(item,pos) { 
              context.font      = "normal 14px Ubuntu";
              context.lineWidth = 1;
              context.fillStyle = "#000000";
              context.fillText(item.name, 65, 135+pos*60);
              context.fillStyle = "#f0f0f0";
              context.font      = "bold 25px Ubuntu";
              context.fillText(item.n, 20, 135+pos*60+20);
              }
 
     function drawBar(item,pos,rate) {
              context.fillStyle = "#007000";
              for (var i=0; i <= 50*rate;i++) {
                if (i>50*0.7) context.fillStyle = "#700000";
               context.fillRect(65+i*4,120+pos*60+27,2,20); } }

     function drawSection(item,pos) {
              drawSquare(0,pos*60,item);
              drawSectionName(item,pos);
              drawBar(item,pos,Math.random()); }

     function drawSector(x,y,inner_radius,outer_radius,startAngle,endAngle,max) { 
              context.arc(x, y, inner_radius, startAngle, endAngle, true);
              context.arc(x, y, outer_radius, endAngle, startAngle, false); }

     function drawServer(pos,color,max) {
              context.beginPath();
              context.lineWidth = 3;
              startAngle = -Math.PI*2/max*(pos-1);
              endAngle = -Math.PI*2/max*(pos);
              context.fillStyle = color;
              drawSector(x,y,inner_radius,outer_radius,startAngle,endAngle,max);
              context.fill();
              context.stroke(); }

     function drawBus(start,end,max,inner_radius_bus,outer_radius_bus) { 
              context.beginPath();
              context.lineWidth = 1;
              startAngle = -Math.PI*2/max*start;
              endAngle = -Math.PI*2/max*end;
              drawSector(x,y,inner_radius_bus,outer_radius_bus,startAngle,endAngle,max);
              context.stroke(); }

      var canvas = document.getElementById('mandala');
      var context = canvas.getContext('2d');
      context.strokeStyle = "#362638";
      var x = canvas.width / 2;
      var y = canvas.height / 2;
      var inner_radius = y / 4;
      var outer_radius = y / 2;
      var palette = ["#362698","#8080FF","#F0C80E","#3F807F","#ED7651","#7E7EB8"];
      var cloud = [{n:3, color:0,name:"game"},
                   {n:7, color:1,name:"mq"},
                   {n:5, color:2,name:"app"},
                   {n:1, color:3,name:"monitor"},
                   {n:1, color:4,name:"backup-stream"},
                   {n:8, color:5,name:"web"}
                   ];
      var i = 0; var sec = 0;
      var max = 0;
      cloud.map(function(item) { max += item.n; });
      cloud.map(function(item) { left = i; right = i + item.n; i = right;
           for (var k = left+1; k <= right; k++) drawServer(k,palette[item.color],max);
           drawSection(item,sec++);
           drawBus(left,right,max,inner_radius,y/6);
           drawBus(left,right,max,outer_radius,y*0.58);
      });
    </script>

</body>
</html>
